# Production Configuration for Fly.io Deployment
spring.application.name=web-based-vehicle-rental

# Database Configuration (from environment variables)
spring.datasource.url=${SPRING_DATASOURCE_URL}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA Configuration - Production optimized
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.format_sql=false

# Server Configuration
server.port=${PORT:8080}

# Thymeleaf - Enable caching in production
spring.thymeleaf.cache=true

# Logging - Production level
logging.level.root=INFO
logging.level.com.example.web_based_vehicle_rental=INFO
logging.level.org.springframework.security=WARN

# Stripe Configuration (from environment variables)
stripe.api.key=${STRIPE_SECRET_KEY:}
stripe.publishable.key=${STRIPE_PUBLISHABLE_KEY:}
stripe.cancellation.fee.percentage=10

# File upload settings
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# Gmail SMTP Configuration (from environment variables)
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=${MAIL_USERNAME:}
spring.mail.password=${MAIL_PASSWORD:}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.connectiontimeout=10000
spring.mail.properties.mail.smtp.timeout=10000
spring.mail.properties.mail.smtp.writetimeout=10000

# Application URL for email links (replace with your Fly.io URL)
app.base.url=${APP_BASE_URL:https://vehicle-rental-app.fly.dev}

# HikariCP Connection Pool Optimization for Production
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.leak-detection-threshold=60000

# Hibernate Performance Optimization
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.batch_versioned_data=true

# Enable second-level cache
spring.jpa.properties.hibernate.cache.use_second_level_cache=true
spring.jpa.properties.hibernate.cache.region.factory_class=org.hibernate.cache.jcache.JCacheRegionFactory

# Cache Configuration
spring.cache.type=caffeine
spring.cache.cache-names=vehicles,availableVehicles,reviewStatistics,userReservations
spring.cache.caffeine.spec=maximumSize=1000,expireAfterWrite=5m,expireAfterAccess=10m

# Actuator Configuration for Health Checks
management.endpoints.web.exposure.include=health,info,prometheus
management.endpoint.health.show-details=when-authorized
management.endpoint.health.probes.enabled=true
management.health.livenessstate.enabled=true
management.health.readinessstate.enabled=true

# Security
server.error.include-message=never
server.error.include-stacktrace=never
